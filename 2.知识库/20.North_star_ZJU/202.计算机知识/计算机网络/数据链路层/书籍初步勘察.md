# 数据链路层功能

链路是物理线路，也可以称物理链路
数据链路，也可以称逻辑链路  是物理链路的基础上加一些实现通信协议的硬件和软件。

数据链路层的三大功能
- 封装成帧：帧首部，帧尾部，把IP数据报一夹！这不就成帧了。其中的概念：帧定界功能、数据部分长度上线---最大传送单元MTU、特殊的帧定界符
“当数据在传输中出现差错时，帧定界符的作用更加明显。假定发送端在尚未发送完一个帧时突然出故障，中断了发送。但随后很快又恢复正常，于是重新从头开始发送刚才未发送完的帧。由于使用了帧定界符，接收端就知道前面收到的数据是个不完整的帧(只有首部开始符SOH而没有传输结束符EOT)，必须丢弃。而后面收到的数据有明确的定界符(SOH 和 EOT)，因此这是一个完整的帧，应当收下。"  <u>我疑惑了， 那不是帧定界符不也可以做到吗? 只要双方规定好帧首部和尾部长啥样</u>
**首部是[源MAC(6字节) + 目标MAC(6字节) + 类型(2字节)]，总共14字节。**  
**现在，接收方开始接收比特流。它读了14个字节，心想：“好，这是一个首部！” 然后它再根据首部里的某个“长度”字段，去读后面的数据。**  
**灾难发生：如果因为网络干扰，最开始的几个比特丢失了，接收方就会从一个错误的位置开始读。它可能会把上一个帧的“数据部分”，错误地当成下一个帧的“首部”。整个后续的解码，就会彻底错位，全盘崩溃！它失去了“再同步”的能力。**
**现在，我们规定，每一个帧，都必须以一个物理上就不可能在数据中出现的、极其特殊的比特组合作为开头和结尾。比如，01111110 (HDLC/PPP协议中的标志)。**

- **它的工作方式：接收方的硬件，就像一个雷达，它不关心收到的比特是什么内容，它只持续地扫描，寻找那个独一-无二的“信号灯”01111110。**
    
- **它的优势：**
    
    1. **明确的边界：只要雷达扫到了01111110，它就知道：“一个帧要开始了！” 接下来的所有比特，都属于这个帧。当它再次扫到01111110时，它就知道：“这个帧结束了！”**
        
    2. **强大的“再同步”能力：回到刚才那个“发送中断”的例子。接收方收到了一个SOH(01111110)，但迟迟等不到EOT(01111110)。它就知道这个帧坏了，直接丢弃。当发送方恢复后，重新发送一个完整的帧[SOH ... EOT]。接收方的雷达，会重新捕捉到这个新的SOH，并开始正确地接收一个全新的、完整的帧。它不会被之前那个“坏掉的”帧所迷惑。**






- 透明传输：我的理解是  站在数据的视角，我只知道我会被安全地传输，其他的啥都不知道。额，感觉蛮奇怪的。反正就是要让数据 变成泯然众人的感觉？  那么站在数据链路层如何把数据一视同仁 并且安全的传输，。但书只讲了，数据若有部分和帧开始/结束符号相同  我们填充转义字符。 <u>额，就感觉有点奇怪，好像哪里链条断了</u>
- 差错检测：小视角的比特差错和大视角的传输差错（帧丢失、重复、失序） 

什么是吞吐量？如何理解 bps是 每秒的byte吗？？
	**不，bps是比特每秒，描述的是一个信道，每秒最多传输的比特。**
	**吞吐量了是指单位时间内 通过一个信道的实际数据量。实际？实际，一定小于等于理论的bps。这个误差是因为多个节点“堵塞”等开销。**
	**但如果只有一个节点，那么此时实际就等于理论。即，对于速率为 R bps 的广播信道**
	**，当仅有一个节点发送数据时，该节点具有 R bps 的吞吐量？**

速率为 R = 100 Mbps 的信道，意味着它**每秒钟**最多可以传输 100 * 10^6 个比特。我们之后提到的**速率R，单位永远是bps**。
# 信道划分
TDM（TIme division Multi吗？）缺陷
- 当场上只有一个人”想说话“，速率被约束到了平均速率R/N

FDM是将信道划分不同的频段，这里，频段的含义，我觉得还我很模糊
**Frequency Division Multiplexing, 频分复用 。整个广播电台的可用频谱很宽，但中央人民广播电台被分配在FM 90.5MHz这个“频段”，交通广播被分配在FM 103.9MHz这个“频段”。这就算叫“频分复用”了**

CDMA 看起来有点神奇 就是加密通话嘛 看起来，根本没有在广播信道碰撞的问题诶
**Code Division Multiple Access, 码分多址。每个人在说话前，都用一种独一无二的“密码本”（码片序列），把自己想说的话（数据）加密了就好像一个房间 日本人说日报话 英国人说英文 中国人说中文   接收方和发送方都明白  其他的也不算噪音 因为根本听不懂**
# 随机接入
### 时隙ALOHA
所有帧由L比特组成，即L个01，一个单位就是1比特吧。即，L为一个**数据帧**的大小
R是信道的速率
 **L/R 的物理意义**：以速率R，完整地发送一个大小为L的**数据帧**，所需要的**时间**。

不行 必须在这里把概念完全厘清了，时间帧，与我们说的数据链路，交换的那个数据单元，有什么区别 这个图怎么理解 ![](db201742834ac2740ae2ee76b2c4277.png)
这里 帧标的1234 都是我们人为标的 只是描述一段时间的意思而已
时隙是T = L/R  也是帧的单位 。

对于P很有趣，可以理解为投硬币 P的概率是正面
首先，投硬币是在检测碰撞后执行的，
投，正面的话，下一个时隙就重传，反面的话，下一个时隙重投硬币。这样，每一个时隙都有可能重传。
即P的概率下一个时隙传 1-P的概率 下一个时隙等待， 

这里有个计算效率，我不想陷进去，但感觉是很能练习思维的，因为这是我的缺陷。我到底要不要推导？总之， 时隙ALOHA最大效率是e分之一，蛮小

### 纯ALOHA
我的理解就是没有时隙而已，时间单位变成帧而已？
然后最大效率推导，仍然不太想看

## CSMA
carrier sense
ALOHA们，都是只顾自己，没有别人哈
CSMA会先听别人，是不是再传输，没有的话再传。这样的话，缩小了碰撞的概率，就是只有，同时听，同时发的，再可能碰撞。
ALOHA们可能是， 一个传输到二分之一帧（诶，一个帧完意思就是传完了，就不占广播信道了对吧？） 一个刚传输  也会碰撞，而听，就会避免
然后CSMA，即使已经在传，也不放松警惕，继续监听，有人想来就取消。因为有时延，所以存在本来听的没人，传的时候又出来人的情况。
![](../../../../../assets1/image/书籍初步勘察-1762939716936.jpeg)
不过感觉这个图有点抽象