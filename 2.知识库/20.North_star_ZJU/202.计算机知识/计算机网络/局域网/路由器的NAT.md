- 您的电脑（私有IP: **192.168.1.100**）
    
- 您的路由器（它有一个由ISP分配的、全球唯一的公网IP: **202.96.134.133**）
    
- 目标：谷歌服务器（公网IP: 142.251.42.78）
    

当您的电脑发出的那个IP数据报，抵达路由器时，它的IP头部是这样的：

- 源IP: **192.168.1.100**
    
- 目标IP: 142.251.42.78
    

路由器一看，心想：“坏了！这个源IP是个‘内部出入证’，要是就这么发出去了，半路肯定被警察（骨干路由器）扔掉！”

当您电脑（192.168.1.100）的浏览器，发起一个随机的**源端口**（比如54321），去访问谷歌（目标端口443）时，这个数据包到达路由器。

NAT模块会做两件事：

1. **替换源IP**：将192.168.1.100 替换为路由器的公网IP 202.96.134.133。
    
2. **替换源端口 (关键!)**：它会**丢弃**掉您电脑自己选的那个54321端口，然后在路由器自己身上，找一个**空闲的、临时的端口**（比如12345），并将这个端口，作为**新的源端口**！
    

然后，它立刻在那本“**NAT转换表**”（您的“账本”）上，郑重地记下这一笔：

|   |   |   |   |   |
|---|---|---|---|---|
|内部IP地址|内部端口|外部IP地址|外部端口|目标IP与端口|
|192.168.1.100|54321|202.96.134.133|12345|142.251.42.78:443|

**第二步 (发送)**

路由器将这个**被修改了“源IP”和“源端口”**的、全新的数据包，发送到互联网。

**第三步 (返程与翻译)**

- 谷歌服务器收到请求后，会向202.96.134.133的12345端口，发回一个响应包。
    
- 这个响应包，到达了我们的路由器。
    
- 路由器一看：“哦，是发给我12345端口的！”
    
- 它立刻去**查询**那本“NAT转换表”，进行一次“**反向翻译**”。
    
- 它在表里，根据“外部IP”和“外部端口”，准确地找到了那条记录，并看到了对应的“内部IP”和“内部端口”：192.168.1.100:54321。
    
- 路由器立刻**再次修改**这个回信包的头部：
    
    - 将**目标IP**，从202.96.134.133，改回**192.168.1.100**。
        
    - 将**目标端口**，从12345，改回**54321**。
        
- 最后，将这个被“翻译”回来的、完美的数据包，通过交换机，发给您的电脑。
    

**您的电脑收到了这个包，它看到的，就是一个源自谷歌、目标是自己54321端口的包。它从头到尾，都不知道中间发生了这场惊心动魄的“偷梁换柱”！**