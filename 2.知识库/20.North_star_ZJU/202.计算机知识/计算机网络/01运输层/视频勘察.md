# 概览
运输层，完全描述的是，俩个主机之间，**进程到进程**的通信协议，屏蔽下面所有细节。
<font color="#f79646">注意</font> **网络层 (IP)**：负责的是**主机到主机 (Host-to-Host)** 的通信

俩种协议，TCP、UDP
- TCP 面向连接、可靠。就是要建立逻辑连接，可靠传输  慢，但绝对流畅 
- UDP 无连接，不可靠   快，但可能会卡
	<u>细节知识点</u>：他们还有许多区别
	- 对单播、多播、广播的支持情况
	- 对应用层报文的处理
	- 对数据传输可靠性的支持情况 
	- 首部对比
# 端口
端口，一个主机有很多进程，可能都需要和另个主机通信， 用端口区分进程。
那么自然的，服务器端要有端口号，
- 熟知端口号：直接分配给一些重要的、固定有的应用协议
- 登记端口号
客户端也有端口号
- 短暂端口号 在运行时动态选择    系统完了就收回，给其他客户端进程

端口有啥用？ 额，ip 域名 端口 好像是这三者联系  然后又有这个 数据报文，无论是UDP数据报还是TCP 有关  也有IP协议封装他们有关  但具体是怎样的细节和关联？ 我看视频没看懂 


1. **最里面：【应用层数据】**
    
    - **内容："GET /index.html"（我要看网页）**
        
    - **注：这里面没有IP，也没有端口。**
        
2. **第二层：【TCP 头部】 (传输层)**
    
    - **这里！这里写着端口！**
        
    - **源端口: 54321 (您浏览器临时的分机号)**
        
    - **目标端口: 80 (服务器Web服务固定的分机号)**
        
    - **作用：告诉接收方的操作系统，把里面的数据转给哪个软件。**
        
3. **第三层：【IP 头部】 (网络层)**
    
    - **这里！这里写着IP地址！**
        
    - **源IP: 192.168.1.100 (您的地址)**
        
    - **目标IP: 142.251.42.78 (谷歌的地址)**
        
    - **作用：告诉路由器，这个包要发往世界的哪个角落。**
        
4. **最外层：【以太网 头部】 (数据链路层)**
    
    - **这里！这里写着MAC地址！**
        
    - **目标MAC: 路由器的MAC**
        
    - **作用：告诉交换机，下一跳给谁。**
        

**回答您的关联疑问：**

- **端口写在哪？ 写在 TCP头 或 UDP头 里。**

- **IP协议封装有关？ 是的。IP协议把“TCP头+数据”看作一个整体（货物），并在外面贴上IP头。IP头里不包含端口信息，IP协议也不关心端口，它只管送到大楼（主机）。**

- **谁在看端口？ 只有发送端和接收端的传输层（操作系统内核）在看端口。中间的路由器只看IP，不看端口（除非是NAT路由器）。**



# TCP
我们了解了运输层作用，TCP、UDP的大概区别，  端口的作用
剩下的，allin TCP这个机制
- TCP报文段的**首部格式**
	- 源/目端口（分用复用）
	- **序号 (Seq)** & **确认号 (ACK)** （实现可靠传输的基石）
	- **窗口 (Window)** （实现流量控制）
	- 标志位 (SYN, FIN, ACK, RST) （实现连接管理）

- TCP协议下，主机**建立连接**的过程：三报文握手 ；主机**释放连接**的过程：四报文挥手

- TCP的可靠传输机制，思考的是如何保证数据无差错，不丢失，不重复，有序
	1. **校验**：查错。
    2. **序号**：保证有序，去重。
    3. **确认**：告诉发送方“我收到了”。（累积确认）
    4. **重传**：**超时重传**（保底）、**冗余ACK/快重传**（加速）。
- 上一个知识点，可以知道，主、客机是互相发送数据的。  所以就有**流量控制**这个知识点。主要是保护**接收方**
	- 滑动窗口机制
- 由于各种因素，全局的，正常的流量控制出问题怎么办？所以就有**拥塞控制**。这里就有细分知识点了
	- 慢开始
	- 拥塞避免
	- 快重传
	- 快恢复

