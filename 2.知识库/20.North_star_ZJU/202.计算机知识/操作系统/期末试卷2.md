### **面向用户的**文件**组织结构属于（ ）**

- **你的错选**：A (虚拟结构)
    
- **正确答案**：**C (逻辑结构)**
    
- **你的疑惑**：箭头指来指去，最后不知道为什么是 C。
    
- **深度辨析（必考）**：  
    文件结构分为两层：给**人**看的，和给**机器**看的。
    
    1. **逻辑结构 (给用户看的)**：
        
        - **定义**：用户怎么组织数据？
            
        - **例子**：
            
            - **有结构（记录式）**：数据库、Excel。用户看到的是一行行记录。
                
            - **无结构（流式）**：MP3、TXT。用户看到的是一串连绵不断的字符/声音流。
                
        - **为什么选 C**：题目问“面向用户”，用户只关心“这是不是一篇完整的文章”，不关心它在硬盘上是不是碎成八瓣。
            
    2. **物理结构 (给系统/硬盘看的)**：
        
        - **定义**：数据在盘片上怎么摆放？
            
        - **例子**：连续分配、链接分配（链表）、索引分配（Inode）。
            
    3. **虚拟结构**：这是你自己发明的词，OS 里没有这个分类。只有“虚拟文件系统(VFS)”，但那是接口层。
        

---
### **8. 分布式系统应具备以下哪三种基本功能（ ）**

- **你的选择**：D （**正确**）
    
- **你的疑惑**：划线了“分布式系统”。
    
- **解析**：
    
    - **单机系统**（普通 OS）：管内存、管硬盘、管进程（对应选项 A、B）。
        
    - **分布式系统**（多台电脑连起来）：核心是**“哪怕隔着网线，我们也能像一家人一样工作”**。
        
    - **D 选项的关键词**：
        
        - **通信**：一定要联网说话。
            
        - **资源共享**：我的打印机你也能用。
            
        - **协同工作**：一个任务太重，大家分着干。
            
    - 这三个词是分布式的**灵魂**。
### **1. 操作系统的所有程序都必须常驻内存。（×）**

- **你的疑惑**：画了个问号。
    
- **解析**：
    
    - **常驻的 (Resident)**：只有**内核的核心部分**（如中断处理、时钟管理、进程调度）必须一直在内存里，因为它们随时都要工作，哪怕一毫秒不在都不行。
        
    - **非常驻的**：操作系统的**非核心部分**（如 GUI 界面、打印机驱动、一些不常用的系统工具）平时可以呆在硬盘里，要用的时候才调入内存。
        
    - **结论**：如果 OS 所有程序都常驻，那内存早就被 OS 占光了，用户程序没法跑了。

### **. 多级文件目录可以提高文件的查询速度。（√）**

- **你的错判**：你打了个叉，觉得不行。
    
- **解析**：
    
    - **对比场景**：
        
        - **单级目录**：一个大袋子装了 10 万个文件。你要找 test.c，得从头翻到尾（线性查找），慢死。
            
        - **多级目录（树形）**：分类存放。/home/user/code/test.c。
            
    - **为什么快**：
        
        - 虽然路径变长了，但每一步的搜索范围变小了！
            
        - 比如你在 code 文件夹里找，只需要在这个文件夹的 10 个文件里找，而不需要在全盘 10 万个文件里找。
            
    - **核心功能**：多级目录主要解决了**文件重名**问题，顺带**提高了检索效率**（分解了搜索空间）。

### **8. 在操作系统中，用户程序申请使用 I/O 设备时，通常使用逻辑设备名。（√）**

- **你的疑惑**：画了问号。
    
- **解析**：这就是我们之前讲的**“设备独立性”**。
    
    - **逻辑设备名**：PRINTER（打印机）。
        
    - **物理设备名**：HP_LaserJet_1020_USB_Port_3。
        
    - **原因**：你写程序时，肯定不想把打印机型号写死在代码里。你只申请“我要一台打印机（逻辑名）”，操作系统负责把你分配给具体的那台 HP 打印机（物理名）。这就是**重定向**的基础。



# 大题

### **2. 虚拟内存（虚存）空间的大小由什么因素决定？**

*   **你的回答（蓝色）**：
    > 首先上界应该是外存+内存容量... 其次 ？？？
*   **诊断**：你卡在了“其次”上。你只看到了**物理限制**，没看到**逻辑限制**。
*   **填补盲区（必考！）**：
    *   **限制一（你写出来的）**：**实际容量** = 内存 + 外存（Swap区）。你硬盘一共就这么大，虚存再大也没地方存数据。
    *   **限制二（你卡住的）**：**计算机的地址位数（寻址范围）**。
        *   **例子**：32位的 CPU，哪怕你装了 100TB 的硬盘，它最多也只能认出 $2^{32} = 4GB$ 的地址空间。多出来的它根本没法编码。
*   **结论（背这个公式）**：
    $$虚存最大容量 = \min(2^{\text{计算机位数}}, \text{内存容量} + \text{外存容量})$$

---

### **3. 文件目录和目录文件各起什么作用？目前广泛采用...？**

*   **你的回答（蓝色）**：
    > 这一大段写得非常纠结，试图厘清 FCB 和 目录 的关系。
    > *"目录文件，是文件目录组成的文件... 它也是我们一般指的'目录'或'文件夹'（对吗？）"*
*   **诊断**：
    1.  **关于“文件夹”**：**对！** 目录文件就是文件夹。这点要自信。
    2.  **关于 FCB**：你写“文件目录记录着文件的信息，也称为FCB”。这句微瑕。
        *   **精准定义**：**文件目录 (Directory)** 是一个**表**（集合），而 **FCB** 是表里的**一行**（个体）。
        *   应该是：文件目录是 FCB 的**有序集合**。
*   **满分逻辑梳理**：
    *   **文件目录（抽象概念）**：这是一张**清单**，用来实现“按名存取”。
    *   **目录文件（物理实体）**：为了管理这张清单，操作系统把它存成了一个**文件**，这个文件就叫目录文件。
    *   **结构**：**树形结构**（多级目录）。
    *   **优点**：检索快、**允许重名**（这是核心）、层次清晰。
### **第一题：页式存储管理（内存题）**

#### **1. 你的疑惑拆解**

> **疑惑 A：什么叫进程逻辑地址空间？就是说进程大小切分后，占64页大小嘛？**

**正解**：**对！**
*   **逻辑地址空间**：就是这个进程“以为”自己拥有的地盘。
*   题目说“占 64 页”，意思是这个进程觉得自己有 0~63 号页。
*   **页表项数**：既然进程有 64 页，为了能找到每一页去哪了，页表里就得有 **64 行**（64 个页表项）。

> **疑惑 B：物理内存 2M... 逻辑地址是 5位？物理地址...？**

**这里你卡住了，因为你混淆了“页号”和“帧号”的计算源头。**

**我们来算一遍“位数”：**

1.  **物理页帧号（Frame Number）占几位？**
    *   **看物理内存总大小**：2MB。
    *   **看页面大小**：1KB (1024字节)。
    *   **切蛋糕**：物理内存一共被切成了多少块？
        $$2\text{MB} / 1\text{KB} = 2048 \text{ 块}$$
    *   **编号**：要给这 2048 个房间编号（0 ~ 2047），需要多少个二进制位？
        $$2048 = 2^{11}$$
    *   **结论**：物理页帧号占 **11 位**。
    *   *（你的理解是对的：页表项里存的就是这个 11 位的物理房号，跟后面的偏移量没关系。）*

2.  **逻辑页号占几位？（题目没问，但我帮你算）**
    *   进程有 64 页。
    *   $64 = 2^6$。
    *   所以逻辑页号是 **6 位**（你笔记里写的 5 位是 $2^5=32$，算错了哈）。

> **疑惑 C：计算公式 0.85*100 + 0.15*200**

**正解**：**完全正确！**
*   **命中（85%）**：TLB（不用算时间） -> 拿到物理地址 -> 访问内存取数据（1次，100ns）。
*   **未命中（15%）**：TLB没找到 -> 访问内存查页表（1次，100ns） -> 拿到物理地址 -> 访问内存取数据（1次，100ns）。共 200ns。

---

### **第二题：混合索引分配（文件题）**

这道题你觉得“没印象”，是因为它考的是 **Unix Inode 的内部结构**，也就是我们之前讲的“多级索引”。

#### **1. 扫盲：什么是索引表？什么是盘块？**

*   **盘块 (Disk Block)**：硬盘读写的最小单位。题目里说是 1KB（1024字节）。
*   **索引表 (Index Block)**：
    *   普通的盘块里装的是**用户的文字/图片**。
    *   **索引块**里装的全是**地址（指针）**。
    *   **关键计算**：一个盘块 1024 字节，一个地址占 3 字节。那这一个盘块能存多少个地址？
        $$1024 / 3 = 341 \text{ 个}$$
        *(注意：这里是整数除法，存不下半个指针)*
    *   **这意味着**：只要我拥有一个索引块，我就能找到 **341** 个下级盘块。

#### **2. 题目图解：混合索引（0-12号地址项）**

这是一个**套娃**游戏。FCB（Inode）里有 13 个格子，用来记录数据在哪。

*   **0 ~ 9 (直接地址)**：
    *   这 10 个格子，直接写着数据块的号码。
    *   **容量**：$10 \times 1\text{KB} = 10\text{KB}$。
    *   *(这是给小文件用的，比如存个 Word 文档)*

*   **10 (一次间接地址)**：
    *   这个格子指向一个**索引块**（第 1 层）。
    *   这个索引块里有 **341** 个指针，分别指向数据。
    *   **容量**：$1 \times 341 \times 1\text{KB} = 341\text{KB}$。
    *   *(这是给中型文件用的)*

*   **11 (二次间接地址)**：
    *   这个格子指向一个索引块（第 1 层）。
    *   第 1 层的这 341 个指针，**每一个**都指向另一个索引块（第 2 层）。
    *   第 2 层的每个指针才指向数据。
    *   **容量**：$1 \times 341 \times 341 \times 1\text{KB} = 116,281\text{KB} \approx 113\text{MB}$。
    *   *(这是给大文件用的，比如存个小视频)*

*   **12 (三次间接地址)**：
    *   套三层娃。
    *   **容量**：$1 \times 341 \times 341 \times 341 \times 1\text{KB} \approx 38\text{GB}$。
    *   *(这是给超大文件用的，比如 4K 电影)*

#### **3. 最终计算**

*   **问题 (1)**：每个索引表最多存放多少个地址？
    *   **答案**：$341$ 个。（$1024/3$ 取整）。

*   **问题 (2)**：文件最大长度？
    *   **答案**：把上面四种情况加起来。
    *   $10\text{KB} + 341\text{KB} + 341^2\text{KB} + 341^3\text{KB} \approx 40\text{GB}$。

---

### **总结：如何复习这两块？**

1.  **页式计算**：
    *   分清 **“页（进程的）”** 和 **“页框（内存的）”**。
    *   页表项的行数 = 进程的页数。
    *   页表项的位数 = 物理内存总块数的二进制位数。

2.  **混合索引**：
    *   死记 **1024 / 3 = 341** 这种算出“一个块能存多少个指针”的逻辑。
    *   **一级** = $341$。
    *   **二级** = $341 \times 341$。
    *   **三级** = $341 \times 341 \times 341$。
    *   最后别忘了加上那 10 个直接块。