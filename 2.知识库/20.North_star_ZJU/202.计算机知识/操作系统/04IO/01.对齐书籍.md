#### **第二站：13.4 I/O 内核子系统 (Kernel Subsystem) —— 本章最重要！**

- **核心问题**：内核为了伺候好这些设备，在内部搞了哪些“花活”？
    
- **重点关注**：
    
    - **13.4.1 I/O 调度**：我们学过磁盘调度，那网卡需要调度吗？打印机需要吗？
        
    - **13.4.2 缓冲 (Buffering) vs. 13.4.3 高速缓存 (Caching)**：**这是必考题，也是最容易混淆的点！**
        
        - **找茬任务**：去书里找定义。**缓冲**是为了解决“速度不匹配”和“数据到达大小不一致”的问题（像水库）；**缓存**是为了“保留副本以备再次使用”（像书房）。**它们的目的完全不同！**
            
    - **13.4.4 假脱机 (Spooling)**：这个我们已经讲透了，快速扫一眼确认一下即可。
        

#### **第三站：13.5 把I/O操作转换成硬件操作**

- **核心问题**：从文件名到硬盘扇区，这一路是怎么走通的？
    
- 这部分内容其实就是我们之前梳理的“软件栈”流程。读一下书上的描述，**验证**你之前画的“数据流图”是否准确。
    

#### **第四站：13.7 性能 (Performance)**

- **核心问题**：I/O这么慢，怎么优化？
    
- 这里可能会提到我们刚才说的“中断及其开销”。扫一眼即可，理解I/O是系统性能的瓶颈所在



中断不总是那么好？
因为中断这个切换进程 上下文开销也大，若本来能很快，一次轮询就能解决的，反而可能因为使用中断而变慢 
引发活锁？活锁是?
中断合并也是一种优化方法，但我没理解如何优化了？ 

# 磁盘
磁盘看做一个一维的逻辑块数组？？ 
数组的第一个位置？ 是最外面柱面的第一个磁道的第一个扇区？ 然后以此类推，把所有区域都映射到数组了。
柱面不就是磁道吗？哦？ 还是说一个柱面包含多个磁道。

“磁道离磁盘中心越远，长度越长，因而能容纳更多扇区”
所以书中的“扇区”和视频的“扇区”完全不同诶 视频的扇区是一个披萨块，而书中的描述，是一个固定的面积吧

对于任何调度算法，其性能主要依赖于请求的数量和类型

# I/O硬件
## DMA
其细节是，cpu会将命令块的地址写入到DMA控制器中。DMA是直接操作内存总线。
DMA和设备直接也有协议，有request和acknowledge信号。
DMA传输时要抓住内存总线，所以此时CPU不能访问主内存（诶？还有辅内存？应该是访问缓存吧，缓存是不是不需要内存总线，而是小总线？ 我感觉我对内存的“直觉”不太清晰“）  这叫周期挪用。




#  **I/O 应用接口**
硬盘是**块设备**（随机访问、有缓存），键盘/串口是**字符设备**（流式、不可寻址）
有没有设备既不是块也不是字符?
没搞懂， 没说啊，难道就是网络设备、时钟、定时器？  另外我不知道把设备分成块跟字符是为什么？

非阻塞(Non-blocking)读取时，如果没有数据，read()函数会发生什么？（是挂起进程，还是立刻返回一个错误码？）
”阻塞系统调用“会让应用程序的执行被挂起，，，
非阻塞呢？ 书中没讲啊 书中讲键盘是非阻塞io，为啥啊？  怎么感觉键盘才应该是阻塞，因为他需要返回的东西啊？没返回之前他只能一直轮询才是效率最高的吧？
怎么又来了个”异步系统调用“？？ 
这里又讲了非阻塞 read调用会立马返回，为啥啊？ 没有逻辑链条 

emm 非阻塞 和 异步 挺像
但非阻塞是有轮询的，  每次轮询都会返回值 
异步是中断的 