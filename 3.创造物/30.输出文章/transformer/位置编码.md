### **目标：证明 PE(pos+k) 可以由 PE(pos) 线性变换而来**

我们要证明的是，存在一个**只与k有关**、而**与pos无关**的变换矩阵M_k，使得：

PE(pos+k) = M_k * PE(pos) (这是一个简化的写法)

让我们聚焦于**某一个维度对 (2i, 2i+1)**。如果能证明在这个“二维子空间”里存在这样的变换，那么在整个高维空间里，也同样存在。

**我们来看 PE(pos+k) 在这个维度对上的值：**

- p'_{2i} = sin((pos+k) * ω_i)
    
- p'_{2i+1} = cos((pos+k) * ω_i)
    

**现在，我们拿出高中数学的“杀手锏”——三角函数和差公式：**

- sin(α+β) = sin(α)cos(β) + cos(α)sin(β)
    
- cos(α+β) = cos(α)cos(β) - sin(α)sin(β)
    

令 α = pos * ω_i，β = k * ω_i。代入上面的公式：

- p'_{2i} = sin(pos*ω_i) * cos(k*ω_i) + cos(pos*ω_i) * sin(k*ω_i)
    
- p'_{2i+1} = cos(pos*ω_i) * cos(k*ω_i) - sin(pos*ω_i) * sin(k*ω_i)
    

**现在，我们把 PE(pos) 的原始定义代入进去：**

- sin(pos*ω_i) = p_{2i}
    
- cos(pos*ω_i) = p_{2i+1}
    

**代换后，我们得到：**

- p'_{2i} = p_{2i} * cos(k*ω_i) + p_{2i+1} * sin(k*ω_i)
    
- p'_{2i+1} = p_{2i+1} * cos(k*ω_i) - p_{2i} * sin(k*ω_i)
    

---


让我们把上面这两个代数式，写成**矩阵乘法**的形式。

`[ p'_{2i}, p'_{2i+1} ]` (这是一个行向量)

= [ p_{2i}, p_{2i+1} ] @  
[ cos(k*ω_i) , -sin(k*ω_i) ]  
[ sin(k*ω_i) , cos(k*ω_i) ]

**请仔细看这个 2x2 的矩阵！**

M_{k,i} =  
[ cos(k*ω_i) , -sin(k*ω_i) ]  
[ sin(k*ω_i) , cos(k*ω_i) ]

1. **它里面的所有项，只与k（相对位移）和ω_i（维度）有关。**
    
2. **它与pos（绝对位置）完全无关！**

